<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Msf::Simple::Payload
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!Msf/Simple/Payload.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Msf.html" title="Msf (module)">Msf</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Simple.html" title="Msf::Simple (module)">Simple</a></span></span>
     &raquo; 
    <span class="title">Payload</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Module: Msf::Simple::Payload
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
      <dt class="r1">Includes:</dt>
      <dd class="r1"><span class='object_link'><a href="Module.html" title="Msf::Simple::Module (module)">Module</a></span></dd>
      
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/msf/base/simple/payload.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Simple payload wrapper class for performing generation.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_simple-class_method" title="generate_simple (class method)">+ (Object) <strong>generate_simple</strong>(payload, opts) {|payload| ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Generate a payload with the mad skillz.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#generate_simple-instance_method" title="#generate_simple (instance method)">- (Object) <strong>generate_simple</strong>(opts, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Calls the class method.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module.html" title="Msf::Simple::Module (module)">Module</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module.html#_import_extra_options-instance_method" title="Msf::Simple::Module#_import_extra_options (method)">#_import_extra_options</a></span>, <span class='object_link'><a href="Module.html#init_simplified-instance_method" title="Msf::Simple::Module#init_simplified (method)">#init_simplified</a></span>, <span class='object_link'><a href="Module.html#inspect-instance_method" title="Msf::Simple::Module#inspect (method)">#inspect</a></span>, <span class='object_link'><a href="Module.html#load_config-instance_method" title="Msf::Simple::Module#load_config (method)">#load_config</a></span>, <span class='object_link'><a href="Module.html#save_config-instance_method" title="Msf::Simple::Module#save_config (method)">#save_config</a></span></p>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="generate_simple-class_method">
  
    + (<tt>Object</tt>) <strong>generate_simple</strong>(payload, opts) {|payload| ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Generate a payload with the mad skillz.  The payload can be generated in a
number of ways.</p>

<p>opts can have:</p>

<pre class="ruby"><span class="ruby-constant">Encoder</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">A</span> <span class="ruby-identifier">encoder</span> <span class="ruby-keyword">module</span> <span class="ruby-identifier">name</span>.
<span class="ruby-constant">BadChars</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">A</span> <span class="ruby-identifier">string</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">bad</span> <span class="ruby-identifier">characters</span>.
<span class="ruby-constant">Format</span>      =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">The</span> <span class="ruby-identifier">format</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">represent</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">data</span> <span class="ruby-identifier">as</span><span class="ruby-operator">:</span> <span class="ruby-identifier">ruby</span>, <span class="ruby-identifier">perl</span>, <span class="ruby-identifier">c</span>, <span class="ruby-identifier">raw</span>
<span class="ruby-constant">Options</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">A</span> <span class="ruby-identifier">hash</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">options</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">set</span>.
<span class="ruby-constant">OptionStr</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">A</span> <span class="ruby-identifier">string</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">options</span> <span class="ruby-keyword">in</span> <span class="ruby-constant">VAR</span>=<span class="ruby-constant">VAL</span> <span class="ruby-identifier">form</span> <span class="ruby-identifier">separated</span> <span class="ruby-identifier">by</span>
               <span class="ruby-identifier">whitespace</span>.
<span class="ruby-constant">NoComment</span>   =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Disables</span> <span class="ruby-identifier">prepention</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">a</span> <span class="ruby-identifier">comment</span>
<span class="ruby-constant">NopSledSize</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">The</span> <span class="ruby-identifier">number</span> <span class="ruby-identifier">of</span> <span class="ruby-constant">NOPs</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">use</span>
<span class="ruby-constant">MaxSize</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">The</span> <span class="ruby-identifier">maximum</span> <span class="ruby-identifier">size</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">payload</span>.
<span class="ruby-constant">Iterations</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Number</span> <span class="ruby-identifier">of</span> <span class="ruby-identifier">times</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">encode</span>.
<span class="ruby-constant">Force</span>       =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Force</span> <span class="ruby-identifier">encoding</span>.
</pre>

<p>raises:</p>

<pre class="ruby"><span class="ruby-constant">BadcharError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">If</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">supplied</span> <span class="ruby-identifier">encoder</span> <span class="ruby-identifier">fails</span> <span class="ruby-identifier">to</span> <span class="ruby-identifier">encode</span> <span class="ruby-identifier">the</span> <span class="ruby-identifier">payload</span>
<span class="ruby-constant">NoKeyError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">No</span> <span class="ruby-identifier">valid</span> <span class="ruby-identifier">encoder</span> <span class="ruby-identifier">key</span> <span class="ruby-identifier">could</span> <span class="ruby-identifier">be</span> <span class="ruby-identifier">found</span>
<span class="ruby-constant">ArgumentParseError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Options</span> <span class="ruby-identifier">were</span> <span class="ruby-identifier">supplied</span> <span class="ruby-identifier">improperly</span>
</pre>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>payload</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/simple/payload.rb', line 41</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_generate_simple'>generate_simple</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>

  <span class='comment'># Clone the module to prevent changes to the original instance
</span>  <span class='id identifier rubyid_payload'>payload</span> <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_replicant'>replicant</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Simple</span><span class='op'>::</span><span class='const'>Framework</span><span class='period'>.</span><span class='id identifier rubyid_simplify_module'>simplify_module</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='rparen'>)</span>
  <span class='kw'>yield</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>

  <span class='comment'># Import any options we may need
</span>  <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid__import_extra_options'>_import_extra_options</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_framework'>framework</span> <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_framework'>framework</span>

  <span class='comment'># Generate the payload
</span>  <span class='id identifier rubyid_e'>e</span> <span class='op'>=</span> <span class='const'>EncodedPayload</span><span class='period'>.</span><span class='id identifier rubyid_create'>create</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BadChars</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BadChars</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MinNops</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NopSledSize</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Encoder</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Encoder</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Iterations</span><span class='tstring_end'>&#39;</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Iterations</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ForceEncode</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ForceEncode</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Space</span><span class='tstring_end'>&#39;</span></span>    <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>MaxSize</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_fmt'>fmt</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Format</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>raw</span><span class='tstring_end'>&#39;</span></span>

  <span class='id identifier rubyid_exeopts'>exeopts</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:inject</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>KeepTemplateWorking</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='symbol'>:template</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Template</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='symbol'>:template_path</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ExeDir</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_arch'>arch</span> <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_arch'>arch</span>
  <span class='id identifier rubyid_plat'>plat</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Platform</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_platform'>platform</span>

  <span class='comment'># Save off the original payload length
</span>  <span class='id identifier rubyid_len'>len</span> <span class='op'>=</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_encoded'>encoded</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>


  <span class='kw'>if</span> <span class='id identifier rubyid_arch'>arch</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='const'>ARCH_JAVA</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_fmt'>fmt</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>war</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>return</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_encoded_war'>encoded_war</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Util</span><span class='op'>::</span><span class='const'>EXE</span><span class='period'>.</span><span class='id identifier rubyid_to_executable_fmt'>to_executable_fmt</span><span class='lparen'>(</span><span class='id identifier rubyid_framework'>framework</span><span class='comma'>,</span> <span class='id identifier rubyid_arch'>arch</span><span class='comma'>,</span> <span class='id identifier rubyid_plat'>plat</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_encoded'>encoded</span><span class='comma'>,</span> <span class='id identifier rubyid_fmt'>fmt</span><span class='comma'>,</span> <span class='id identifier rubyid_exeopts'>exeopts</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_output'>output</span>
    <span class='comment'># Generate jar if necessary
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_fmt'>fmt</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>jar</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>return</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_encoded_jar'>encoded_jar</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span>
    <span class='kw'>end</span>

    <span class='comment'># Serialize the generated payload to some sort of format
</span>    <span class='id identifier rubyid_fmt'>fmt</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ruby</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='const'>Buffer</span><span class='period'>.</span><span class='id identifier rubyid_transform'>transform</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_encoded'>encoded</span><span class='comma'>,</span> <span class='id identifier rubyid_fmt'>fmt</span><span class='rparen'>)</span>

    <span class='comment'># Prepend a comment
</span>    <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_fmt'>fmt</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>raw</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NoComment</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='kw'>true</span><span class='rparen'>)</span>
      <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_ou'>ou</span> <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_options'>options</span><span class='period'>.</span><span class='id identifier rubyid_options_used_to_s'>options_used_to_s</span><span class='lparen'>(</span><span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_datastore'>datastore</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_ou'>ou</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id identifier rubyid_ou'>ou</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='id identifier rubyid_ou'>ou</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span>
        <span class='const'>Buffer</span><span class='period'>.</span><span class='id identifier rubyid_comment'>comment</span><span class='lparen'>(</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'> - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_len'>len</span><span class='embexpr_end'>}</span><span class='tstring_content'> bytes</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_staged?'>staged?</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> (stage 1)</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://www.metasploit.com\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
          <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_encoder'>encoder</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Encoder: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_encoder'>encoder</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>
          <span class='lparen'>(</span><span class='lparen'>(</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_nop'>nop</span><span class='rparen'>)</span> <span class='op'>?</span>     <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NOP gen: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_nop'>nop</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ou'>ou</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='id identifier rubyid_fmt'>fmt</span><span class='rparen'>)</span> <span class='op'>+</span>
        <span class='id identifier rubyid_output'>output</span>

      <span class='comment'># If it&#39;s multistage, include the second stage too
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_staged?'>staged?</span>
        <span class='id identifier rubyid_stage'>stage</span> <span class='op'>=</span> <span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_generate_stage'>generate_stage</span>

        <span class='comment'># If a stage was generated, then display it
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_stage'>stage</span> <span class='kw'>and</span> <span class='id identifier rubyid_stage'>stage</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
          <span class='id identifier rubyid_output'>output</span> <span class='op'>+=</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
            <span class='const'>Buffer</span><span class='period'>.</span><span class='id identifier rubyid_comment'>comment</span><span class='lparen'>(</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_payload'>payload</span><span class='period'>.</span><span class='id identifier rubyid_refname'>refname</span><span class='embexpr_end'>}</span><span class='tstring_content'> - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stage'>stage</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'> bytes (stage 2)\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://www.metasploit.com\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
              <span class='id identifier rubyid_fmt'>fmt</span><span class='rparen'>)</span> <span class='op'>+</span>
            <span class='const'>Buffer</span><span class='period'>.</span><span class='id identifier rubyid_transform'>transform</span><span class='lparen'>(</span><span class='id identifier rubyid_stage'>stage</span><span class='comma'>,</span> <span class='id identifier rubyid_fmt'>fmt</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

    <span class='kw'>end</span>

  <span class='kw'>end</span>

  <span class='comment'># How to warn?
</span>  <span class='comment'>#if exeopts[:fellback]
</span>  <span class='comment'>#	$stderr.puts(OutError + &quot;Warning: Falling back to default template: #{exeopts[:fellback]}&quot;)
</span>  <span class='comment'>#end
</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="generate_simple-instance_method">
  
    - (<tt>Object</tt>) <strong>generate_simple</strong>(opts, &amp;block) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Calls the class method.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/msf/base/simple/payload.rb', line 136</span>

<span class='kw'>def</span> <span class='id identifier rubyid_generate_simple'>generate_simple</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='const'>Msf</span><span class='op'>::</span><span class='const'>Simple</span><span class='op'>::</span><span class='const'>Payload</span><span class='period'>.</span><span class='id identifier rubyid_generate_simple'>generate_simple</span><span class='lparen'>(</span><span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Wed Feb 11 11:56:32 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.5).
</div>

  </body>
</html>